(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-affcb49e"],{1965:function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"user-controller-container"},[t("el-container",[t("el-header",[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:12}},[e.$store.state.user.user_role?t("el-button",{on:{click:function(r){e.addFormShow=!0}}},[e._v("注册新用户")]):e._e()],1),t("el-col",{attrs:{span:8}},[t("span",{staticStyle:{opacity:"0"}},[e._v("1")])]),t("el-col",{attrs:{span:4}},[t("p",[e._v("当前用户数量："+e._s(e.$store.state.userController.userCount))])])],1)],1),t("el-main",[t("el-table",{attrs:{data:e.userList,height:"500",border:"","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"}}},[t("el-table-column",{attrs:{prop:"user_name",label:"用户名",width:"200"}}),t("el-table-column",{attrs:{prop:"user_role",label:"用户权限",width:"200"}}),t("el-table-column",{attrs:{prop:"user_phone",label:"联系方式",width:"250"}}),t("el-table-column",{attrs:{prop:"address",label:"地址"}}),e.$store.state.user.user_role?t("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteUser(r.row)}}},[e._v("删除")])]}}],null,!1,2162000983)}):e._e()],1)],1)],1),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"注册新用户",visible:e.addFormShow,width:"400px"},on:{"update:visible":function(r){e.addFormShow=r}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth,required:"",prop:"user_name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.user_name,callback:function(r){e.$set(e.addForm,"user_name",r)},expression:"addForm.user_name"}})],1),t("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,required:"",prop:"user_pwd"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.addForm.user_pwd,callback:function(r){e.$set(e.addForm,"user_pwd",r)},expression:"addForm.user_pwd"}})],1),t("el-form-item",{attrs:{label:"确认密码","label-width":e.formLabelWidth,required:"",prop:"user_confirmpwd"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.addForm.user_confirmpwd,callback:function(r){e.$set(e.addForm,"user_confirmpwd",r)},expression:"addForm.user_confirmpwd"}})],1),t("el-form-item",{attrs:{label:"用户权限","label-width":e.formLabelWidth,required:"",prop:"user_role"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.user_role,callback:function(r){e.$set(e.addForm,"user_role",r)},expression:"addForm.user_role"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelSubmit}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.addUser("addForm")}}},[e._v("确 定")])],1)],1)],1)},o=[],a=(t("4de4"),t("159b"),{data:function(){return{userList:[],addFormShow:!1,addForm:{user_name:"",user_pwd:"",user_confirmpwd:"",user_role:""},options:[{value:"1",label:"普通用户"},{value:"2",label:"管理员"}],rules:{user_name:[{required:!0,message:"请输入用户名",trigger:"blur"}],user_pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],user_confirmpwd:[{required:!0,message:"请输入密码",trigger:"blur"}],user_role:[{required:!0,message:"请选择用户权限",trigger:"blur"}]},formLabelWidth:"120px"}},created:function(){this.initUserInfo()},methods:{initUserInfo:function(){var e=this;this.$store.dispatch("userController/getUserCount"),this.$store.dispatch("userController/getUserList").then((function(r){e.userList=e.formatArr(r)}))},deleteUser:function(e){var r=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.user_id,s=r,o={user_id:t};s.$store.dispatch("userController/deleteUser",o).then((function(){s.$message({message:"删除成功",type:"success"}),s.initUserInfo()})).catch((function(){s.$message({message:"删除失败",type:"error"})}))})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},formatArr:function(e){var r=this,t=[];return t=e.filter((function(e){return!e.is_delete&&e.user_id!==r.$store.state.user.user_id})),t.forEach((function(e){switch(e.user_role){case 1:e.user_role="普通用户";break;case 2:e.user_role="管理员";break;default:break}for(var r in e)null==e[r]&&(e[r]="--未填写--")})),t},addUser:function(e){var r=this;r.$refs[e].validate((function(e){if(e){var t={user_name:r.addForm.user_name,user_pwd:r.addForm.user_pwd,user_role:r.addForm.user_role};r.addForm.user_pwd!==r.addForm.user_confirmpwd?r.$message({message:"两次输入密码不一致，请重新输入",type:"error"}):(r.$store.dispatch("userController/addUser",t).then((function(){r.$message({message:"添加成功",type:"success"}),r.clearForm(),r.initUserInfo()})),r.addFormShow=!1)}else console.log("error submit!!")}))},clearForm:function(){this.addForm={user_name:"",user_pwd:"",user_confirmpwd:"",user_role:""}},cancelSubmit:function(){this.addFormShow=!1,this.clearForm()}}}),l=a,n=(t("434c"),t("2877")),u=Object(n["a"])(l,s,o,!1,null,"e675ce80",null);r["default"]=u.exports},"434c":function(e,r,t){"use strict";t("7686")},7686:function(e,r,t){}}]);