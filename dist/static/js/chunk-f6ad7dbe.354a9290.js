(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f6ad7dbe"],{"2aa3":function(e,t,s){},"63d3":function(e,t,s){"use strict";s("aa64")},aa64:function(e,t,s){},ec2d:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-setting-container"},[s("el-form",{staticClass:"demo-form-inline",attrs:{model:e.form,"label-position":"top"}},[s("el-form-item",{attrs:{label:"头像"}},[s("my-avatar",{on:{upload:e.uploadImg}})],1),s("el-form-item",{attrs:{label:"用户名"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"username",disabled:""},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}})],1),s("el-col",{attrs:{span:4}},[s("el-button",{on:{click:function(t){return e.updateInfo("user_name")}}},[e._v("修改用户名")])],1)],1)],1),s("el-form-item",{attrs:{label:"联系方式"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{placeholder:"user_phone",disabled:""},model:{value:e.form.user_phone,callback:function(t){e.$set(e.form,"user_phone",t)},expression:"form.user_phone"}})],1),s("el-col",{attrs:{span:4}},[s("el-button",{on:{click:function(t){return e.updateInfo("user_phone")}}},[e._v("修改联系方式")])],1)],1)],1),s("el-form-item",{attrs:{label:"地址"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{placeholder:"address",disabled:""},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),s("el-col",{attrs:{span:4}},[s("el-button",{on:{click:function(t){return e.updateInfo("address")}}},[e._v("修改地址")])],1)],1)],1),s("el-form-item",{attrs:{label:"密码"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"user_pwd",disabled:"",type:"password"},model:{value:e.form.user_pwd,callback:function(t){e.$set(e.form,"user_pwd",t)},expression:"form.user_pwd"}})],1),s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"warning"},on:{click:function(t){e.pwdVisible=!0}}},[e._v("修改密码")])],1)],1)],1)],1),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"修改密码",visible:e.pwdVisible,width:"400px"},on:{"update:visible":function(t){e.pwdVisible=t}}},[s("el-form",{ref:"pwd",attrs:{model:e.form,rules:e.rules}},[s("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,prop:"user_pwd"}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:e.form.user_pwd,callback:function(t){e.$set(e.form,"user_pwd",t)},expression:"form.user_pwd"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancelForm}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updatePwd}},[e._v("确 定")])],1)],1)],1)},r=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"avatar"},[s("input",{ref:"file",staticClass:"file",attrs:{type:"file"},on:{change:e.chooseAvatar}}),s("div",{class:e.src?"wrap":"shadow",on:{click:e.triggerFile}},[e.src?s("img",{attrs:{src:e.src,alt:""}}):e._e()])])},o=[],i={name:"MyAvatar",data:function(){return{src:""}},methods:{triggerFile:function(){this.$refs.file.click()},chooseAvatar:function(){var e=this.$refs.file.files[0],t=this;function s(){var s=/^image\//;if(s.test(e.type)){var a=new FileReader;a.onload=function(e){t.src=e.target.result},a.readAsDataURL(e),t.$emit("upload",e)}else t.src="",t.$message("只支持上传图片类型")}s()}}},l=i,c=(s("ec5e"),s("2877")),u=Object(c["a"])(l,n,o,!1,null,"3fbaf194",null),p=u.exports,d={components:{MyAvatar:p},data:function(){return{form:{},options:{user_name:"用户名",user_phone:"联系方式",address:"地址"},pwdVisible:!1,rules:{user_pwd:[{required:!0,trigger:"blur",message:"请输入密码"}]}}},created:function(){var e=this;this.$store.dispatch("userSetting/getInfo").then((function(t){e.form=t}))},methods:{uploadImg:function(e){var t=this,s=new FormData;s.append("pictureFile",e),this.$store.dispatch("userSetting/updateAvatar",s).then((function(e){t.$message({type:"success",message:e}),t.$store.dispatch("user/getInfo")}))},updateInfo:function(e){var t=this,s=this.options[e];this.$prompt("请输入".concat(s),"修改".concat(s),{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.+/,inputErrorMessage:"".concat(s,"不能为空")}).then((function(s){var a=s.value,r=new FormData;r.append(e,a),t.$store.dispatch("userSetting/updateInfo",r).then((function(e){t.$message({type:"success",message:e}),t.$store.dispatch("user/getInfo").then((function(e){t.form=e}))}))})).catch((function(){t.$message({type:"info",message:"取消修改"})}))},updatePwd:function(){var e=this;this.$refs["pwd"].validate((function(t){t&&e.$confirm("确认修改密码?","修改密码",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(t){var s=t.value,a=new FormData;a.append("user_pwd",s),e.$store.dispatch("userSetting/updateInfo",a).then((function(t){e.$message({type:"success",message:t})}))})).catch((function(){e.$message({type:"info",message:"取消修改"})}))}))},cancelForm:function(){this.pwdVisible=!1,this.form.user_pwd=""}}},f=d,m=(s("63d3"),Object(c["a"])(f,a,r,!1,null,"005da46f",null));t["default"]=m.exports},ec5e:function(e,t,s){"use strict";s("2aa3")}}]);